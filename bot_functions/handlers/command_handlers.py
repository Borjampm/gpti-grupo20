from telegram import Update
from telegram.ext import ContextTypes
from ..state_manager import set_user_state, IDLE, AWAITING_OPTION

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Handle /start command - welcome user and set state to IDLE"""
    chat_id = update.message.chat_id
    set_user_state(chat_id, IDLE)
    await update.message.reply_text(
        "¬°Hola! üëã Bienvenido al bot de procesamiento de archivos.\n\n"
        "ü§ñ **Simplemente describe lo que quieres hacer** y yo entender√© tu solicitud:\n"
        "‚Ä¢ \"Quiero unir dos PDFs\"\n"
        "‚Ä¢ \"Convierte esta imagen a PNG\"\n"
        "‚Ä¢ \"Extrae las p√°ginas 2-5 de un PDF\"\n\n"
        "üìã O usa **/manual** para ver todas las opciones numeradas.\n"
        "‚ÑπÔ∏è Usa **/help** para ver la lista completa de funciones disponibles."
    )

async def help(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Handle /help command - show available functions list only"""
    chat_id = update.message.chat_id
    # Don't change state - keep it as informational only
    await update.message.reply_text(
        "‚ÑπÔ∏è **Lista de funciones disponibles:**\n\n"
        "**üìÑ Operaciones con PDF:**\n"
        "1. Concatenar dos archivos PDF\n"
        "2. Concatenar m√∫ltiples archivos PDF\n"
        "3. Eliminar p√°ginas espec√≠ficas de un PDF\n"
        "4. Extraer p√°ginas espec√≠ficas de un PDF\n"
        "5. Reordenar p√°ginas de un PDF\n\n"
        "**üñºÔ∏è Conversiones de imagen:**\n"
        "6. JPEG ‚Üí PNG\n"
        "7. PNG ‚Üí JPEG\n"
        "8. PDF ‚Üí PNG (primera p√°gina)\n"
        "9. PDF ‚Üí PNG (todas las p√°ginas)\n"
        "10. SVG ‚Üí PNG\n"
        "11. SVG ‚Üí JPEG\n\n"
        "**üóúÔ∏è Operaciones con ZIP:**\n"
        "12. Crear ZIP con varios archivos\n"
        "13. Extraer archivos de un ZIP\n"
        "14. Listar contenidos de un ZIP\n"
        "15. Agregar archivos a un ZIP existente\n"
        "16. Eliminar archivos de un ZIP\n\n"
        "**üóúÔ∏è Operaciones masivas en ZIP:**\n"
        "17. Convertir todas las im√°genes PNG a JPEG dentro de un ZIP\n"
        "18. Convertir todas las im√°genes JPEG a PNG dentro de un ZIP\n"
        "19. Convertir todos los archivos SVG a PNG dentro de un ZIP\n"
        "20. Convertir todos los archivos SVG a JPEG dentro de un ZIP\n"
        "21. Concatenar todos los PDFs dentro de un ZIP\n\n"
        "üí° **Para seleccionar directamente por n√∫mero, usa /manual**"
    )

async def about(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Handle /about command"""
    await update.message.reply_text(
        "ü§ñ **Bot de Procesamiento de Archivos**\n\n"
        "Soy un bot que puede procesar archivos PDF, im√°genes y ZIP de diferentes maneras:\n"
        "‚Ä¢ Combinar y manipular archivos PDF\n"
        "‚Ä¢ Convertir entre formatos de imagen\n"
        "‚Ä¢ Extraer im√°genes desde PDFs\n"
        "‚Ä¢ Convertir archivos SVG\n"
        "‚Ä¢ Crear y gestionar archivos ZIP\n"
        "‚Ä¢ Realizar operaciones en masa dentro de ZIP\n\n"
        "**L√≠mites:**\n"
        "‚Ä¢ Tama√±o m√°ximo por archivo: 20 MB\n"
        "‚Ä¢ Formatos soportados: PDF, PNG, JPEG, SVG, ZIP\n\n"
        "Escribe /help para ver todas las opciones disponibles."
    )

async def manual(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Handle /manual command - allows direct action selection"""
    chat_id = update.message.chat_id
    set_user_state(chat_id, AWAITING_OPTION)
    await update.message.reply_text(
        "üîß **Modo Manual**\n\n"
        "Env√≠a directamente el n√∫mero de la acci√≥n que deseas realizar (1-21):\n\n"
        "**üìÑ Operaciones con PDF:**\n"
        "1. Concatenar dos archivos PDF\n"
        "2. Concatenar m√∫ltiples archivos PDF\n"
        "3. Eliminar p√°ginas espec√≠ficas de un PDF\n"
        "4. Extraer p√°ginas espec√≠ficas de un PDF\n"
        "5. Reordenar p√°ginas de un PDF\n\n"
        "**üñºÔ∏è Conversiones de imagen:**\n"
        "6. JPEG ‚Üí PNG\n"
        "7. PNG ‚Üí JPEG\n"
        "8. PDF ‚Üí PNG (primera p√°gina)\n"
        "9. PDF ‚Üí PNG (todas las p√°ginas)\n"
        "10. SVG ‚Üí PNG\n"
        "11. SVG ‚Üí JPEG\n\n"
        "**üóúÔ∏è Operaciones con ZIP:**\n"
        "12. Crear ZIP con varios archivos\n"
        "13. Extraer archivos de un ZIP\n"
        "14. Listar contenidos de un ZIP\n"
        "15. Agregar archivos a un ZIP existente\n"
        "16. Eliminar archivos de un ZIP\n\n"
        "**üóúÔ∏è Operaciones masivas en ZIP:**\n"
        "17. Convertir todas las im√°genes PNG a JPEG dentro de un ZIP\n"
        "18. Convertir todas las im√°genes JPEG a PNG dentro de un ZIP\n"
        "19. Convertir todos los archivos SVG a PNG dentro de un ZIP\n"
        "20. Convertir todos los archivos SVG a JPEG dentro de un ZIP\n"
        "21. Concatenar todos los PDFs dentro de un ZIP\n"
    )


